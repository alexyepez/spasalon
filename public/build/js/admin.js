function iniciarApp(){console.log("Iniciando app")}function iniciarGestionTerapeutas(){console.log("Iniciando gestión de terapeutas");const e=document.querySelector("#form-asignar-cita"),o=document.querySelector("#form-editar-terapeuta"),a=document.querySelectorAll(".editar-terapeuta"),t=document.querySelectorAll(".eliminar-terapeuta"),r=document.querySelector("#btn-cerrar-modal-terapeuta"),n=document.querySelector("#modal-terapeuta");console.log("Botones editar encontrados:",a.length),console.log("Botones eliminar encontrados:",t.length),e&&(console.log("Configurando formulario de asignar cita"),e.addEventListener("submit",asignarCitaAterapeuta)),a.length>0&&(console.log("Configurando botones de editar"),a.forEach((e=>{e.addEventListener("click",(function(e){console.log("Botón editar clickeado"),mostrarModalEditar(e)}))}))),t.length>0&&(console.log("Configurando botones de eliminar"),t.forEach((e=>{e.addEventListener("click",(function(e){console.log("Botón eliminar clickeado"),confirmarEliminarTerapeuta(e)}))}))),o&&(console.log("Configurando formulario de editar terapeuta"),o.addEventListener("submit",actualizarTerapeuta)),r&&(console.log("Configurando botón cerrar modal"),r.addEventListener("click",(()=>{console.log("Cerrando modal"),n.style.display="none"})))}function mostrarModalEditar(e){const o=e.currentTarget,a=o.dataset.id,t=o.dataset.nombre,r=o.dataset.apellido,n=o.dataset.email,i=o.dataset.telefono,l=o.dataset.especialidad;document.querySelector("#edit-terapeuta-id").value=a,document.querySelector("#edit-nombre").value=t,document.querySelector("#edit-apellido").value=r,document.querySelector("#edit-email").value=n,document.querySelector("#edit-telefono").value=i,document.querySelector("#edit-especialidad").value=l,document.querySelector("#modal-terapeuta").style.display="block"}async function actualizarTerapeuta(e){e.preventDefault(),console.log("Actualizando terapeuta...");const o=new FormData(e.target);try{console.log("Enviando datos al servidor...");const e="/admin/actualizar-terapeuta",a=await fetch(e,{method:"POST",body:o});if(console.log("Respuesta recibida, estado:",a.status),!a.ok)throw new Error(`Error HTTP: ${a.status}`);const t=await a.text();let r;console.log("Respuesta del servidor (texto):",t);try{r=JSON.parse(t),console.log("Respuesta del servidor (JSON):",r)}catch(e){throw console.error("Error al parsear respuesta JSON:",e),console.error("Texto recibido:",t),new Error("La respuesta del servidor no es JSON válido")}r.resultado?(mostrarAlerta("Terapeuta actualizado correctamente","exito",".modal-contenido"),setTimeout((()=>{window.location.reload()}),2e3)):mostrarAlerta(r.mensaje||"Error al actualizar terapeuta","error",".modal-contenido")}catch(e){console.error("Error en try/catch:",e),mostrarAlerta(`Error: ${e.message}`,"error",".modal-contenido")}}function confirmarEliminarTerapeuta(e){if(confirm("¿Estás seguro de eliminar este terapeuta? Esta acción no se puede deshacer.")){eliminarTerapeuta(e.currentTarget.dataset.id)}}async function eliminarTerapeuta(e){console.log("Eliminando terapeuta con ID:",e);try{const o=new FormData;o.append("id",e),console.log("Enviando solicitud para eliminar terapeuta...");const a="/admin/eliminar-terapeuta",t=await fetch(a,{method:"POST",body:o});if(console.log("Respuesta recibida, estado:",t.status),!t.ok)throw new Error(`Error HTTP: ${t.status}`);const r=await t.text();let n;console.log("Respuesta del servidor (texto):",r);try{n=JSON.parse(r),console.log("Respuesta del servidor (JSON):",n)}catch(e){throw console.error("Error al parsear respuesta JSON:",e),console.error("Texto recibido:",r),new Error("La respuesta del servidor no es JSON válido")}n.resultado?(mostrarAlerta("Terapeuta eliminado correctamente","exito",".listado-terapeutas"),setTimeout((()=>{window.location.reload()}),2e3)):mostrarAlerta(n.mensaje||"Error al eliminar terapeuta","error",".listado-terapeutas")}catch(e){console.error("Error en try/catch:",e),mostrarAlerta(`Error: ${e.message}`,"error",".listado-terapeutas")}}async function asignarCitaAterapeuta(e){e.preventDefault();const o=new FormData(this);try{const e="/admin/asignar-cita",a=await fetch(e,{method:"POST",body:o}),t=await a.json();t.resultado?(mostrarAlerta("Cita asignada correctamente","exito","#form-asignar-cita"),setTimeout((()=>{window.location.reload()}),2e3)):mostrarAlerta(t.mensaje||"Error al asignar cita","error","#form-asignar-cita")}catch(e){console.error(e),mostrarAlerta("Error en la comunicación con el servidor","error","#form-asignar-cita")}}function mostrarAlerta(e,o,a){console.log("Mostrando alerta:",e,o,a);const t=document.querySelector(".alerta");t&&t.remove();const r=document.createElement("DIV");r.classList.add("alerta"),r.classList.add(o),r.textContent=e;const n=document.querySelector(a);n?(n.parentElement.insertBefore(r,n),setTimeout((()=>{r.remove()}),5e3)):console.error("Elemento de referencia no encontrado:",a)}document.addEventListener("DOMContentLoaded",(function(){console.log("DOM cargado"),iniciarApp(),(document.querySelector("#form-asignar-cita")||document.querySelector(".listado-terapeutas"))&&(console.log("Página de gestión de terapeutas detectada"),iniciarGestionTerapeutas())}));