function iniciarRecordatorios(){const e=document.querySelector("#form-crear-recordatorio"),t=document.querySelectorAll(".eliminar-recordatorio"),o=document.querySelectorAll(".enviar-recordatorio"),r=document.querySelectorAll(".boton-filtro"),a=document.querySelector("#cliente_id"),n=document.querySelector("#cita_id");e&&e.addEventListener("submit",(function(e){})),t&&t.forEach((e=>{e.addEventListener("click",(function(){eliminarRecordatorio(this.dataset.id)}))})),o&&o.forEach((e=>{e.addEventListener("click",(function(){enviarRecordatorio(this.dataset.id)}))})),r&&r.forEach((e=>{e.addEventListener("click",(function(){aplicarFiltro(this.dataset.filtro),r.forEach((e=>e.classList.remove("activo"))),this.classList.add("activo")}))})),n&&n.addEventListener("change",mostrarDetallesCita),a&&n&&a.addEventListener("change",(function(){const e=this.value;Array.from(n.options).forEach(((t,o)=>{if(0===o)return;const r=t.textContent;""===e||r.includes(`Cliente: ${this.options[this.selectedIndex].textContent.trim()}`)?t.style.display="":t.style.display="none"})),n.value="";const t=document.getElementById("detalles-cita");t&&t.classList.add("oculto")}))}function aplicarFiltro(e){document.querySelectorAll(".recordatorio").forEach((t=>{"todos"===e||"pendientes"===e&&t.classList.contains("recordatorio-pendiente")||"enviados"===e&&t.classList.contains("recordatorio-enviado")?t.style.display="flex":t.style.display="none"}))}function mostrarDetallesCita(){const e=this.value,t=document.getElementById("detalles-cita");if(!e)return void t.classList.add("oculto");const o=this.options[this.selectedIndex].textContent,r=o.includes("Cliente:")?o.split("Cliente:")[1].split("-")[0].trim():"No disponible",a=o.includes("Fecha:")?o.split("Fecha:")[1].trim():"No disponible";t.innerHTML=`\n        <h3>Detalles de la Cita</h3>\n        <p><strong>ID:</strong> <span class="valor-destacado">${e}</span></p>\n        <p><strong>Cliente:</strong> <span class="valor-destacado">${r}</span></p>\n        <p><strong>Fecha:</strong> <span class="valor-destacado">${a}</span></p>\n        <p class="aviso">Se enviará un recordatorio al cliente para esta cita</p>\n    `,t.classList.remove("oculto")}function enviarRecordatorio(e){confirm("¿Deseas enviar este recordatorio ahora?")&&fetch("/admin/enviar-recordatorio",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})}).then((e=>e.json())).then((e=>{e.resultado?(mostrarAlerta("Recordatorio enviado exitosamente","exito",".contenedor-alertas"),setTimeout((()=>location.reload()),2e3)):mostrarAlerta(e.mensaje||"Error al enviar el recordatorio","error",".contenedor-alertas")})).catch((e=>{console.error("Error:",e),mostrarAlerta("Error al enviar el recordatorio","error",".contenedor-alertas")}))}function eliminarRecordatorio(e){confirm("¿Estás seguro de eliminar este recordatorio?")&&fetch("/admin/eliminar-recordatorio",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})}).then((e=>e.json())).then((e=>{e.resultado?(mostrarAlerta("Recordatorio eliminado exitosamente","exito",".contenedor-alertas"),setTimeout((()=>location.reload()),2e3)):mostrarAlerta(e.mensaje||"Error al eliminar el recordatorio","error",".contenedor-alertas")})).catch((e=>{console.error("Error:",e),mostrarAlerta("Error al eliminar el recordatorio","error",".contenedor-alertas")}))}function mostrarAlerta(e,t,o){const r=document.querySelector(`${o} .alerta`);r&&r.remove();const a=document.createElement("DIV");a.classList.add("alerta",t),a.textContent=e,document.querySelector(o).appendChild(a),setTimeout((()=>{a.remove()}),3e3)}document.addEventListener("DOMContentLoaded",(function(){iniciarRecordatorios()}));